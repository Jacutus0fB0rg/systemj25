<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Jacutus0fB0rg">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

    
    <link rel="stylesheet" href="sj25_styles.css"> 

    <style>
            /*Extra small devices (portrait phones, less than 576px)*/
              /*No media query for `xs` since this is the default in Bootstrap*/
      
              /*Extra Small (-xs-) devices (landscape phones, 576px and up)*/
              .LCARS_Bottom_Line {
                    border-radius: 25px 25px 25px 25px;
                    background: purple;
                    color: black;
                }
              .LCARS_Top_Line {
                border-radius: 25px 25px 25px 25px;
                    background: purple;
                    color: black;
              }  
              .LCARS_Message_Panel {
                border-radius: 25px 25px 25px 25px;
                    background: purple;
                    color: black;
              }
                
              /*Small (sm) 576px*/
              @media (min-width: 576px) {
                .LCARS_Bottom_Line {
                      border-radius: 25px 25px 25px 25px;
                      background: purple;
                      color: black;
                  }
      
                  .LCARS_Top_Line {
                    border-radius: 25pt 25pt 25pt 25pt;
                    background: purple;
                    color: black;
                  }
                  .LCARS_Message_Panel {
                    border-radius: 25pt 25pt 25pt 25pt;
                    background: purple;
                    color: black;
                  }

              }
              /*Medium (-md-) devices (tablets, 768px and up)*/
              
              @media (min-width: 768px) {
                .LCARS_Bottom_Line {
                      border-radius: 0px 25px 25px 25px;
                      background: purple;
                      color: black;
                  }
                  .LCARS_Top_Line {
                    border-radius: 25pt 25pt 25pt 0pt;
                    background: purple;
                    color: black;
                  }
                  .LCARS_Message_Panel {
                    border-radius: 25pt 0pt 25pt 25pt;
                    background: purple;
                    color: black;
                  }
              }
              /*Large (-lg-) devices (desktops, 992px and up)*/
              
              @media (min-width: 992px) {
                .LCARS_Bottom_Line {
                      border-radius: 0px 25px 25px 25px;
                      background: purple;
                      color: black;
                  }
                  
                  .LCARS_Top_Line {
                        border-radius: 25pt 25pt 25pt 0pt;
                        background: purple;
                        color: black;
                    }
                    .LCARS_Message_Panel {
                    border-radius: 25pt 0pt 25pt 25pt;
                    background: purple;
                    color: black;
                  }  
              }
              /*Extra large (-xl-) devices (large desktops, 1200px and up)*/
              
              @media (min-width: 1200px) {
                .LCARS_Bottom_Line {
                      border-radius: 0px 25px 25px 25px;
                      background: purple;
                      color: black;
                  }
                  .LCARS_Top_Line {
                        border-radius: 25pt 25pt 25pt 0pt;
                        background: purple;
                        color: black;
                    }
                    .LCARS_Message_Panel {
                    border-radius: 25pt 0pt 25pt 25pt;
                    background: purple;
                    color: black;
                  }
              }
                                    
            </style>

    <title>SystemJ25 Message Board</title>
  </head>
  <body>
      <div class="container-fluid">
            <header>
                 
                <div class="row"> <!--row 1-->
                    <div class="d-none d-sm-none d-md-block col-2 LCARS_Side_Panel">
                        <p>012</p>
                    </div>
                   
                    <div class="col-1"></div>

                    <div class="col-1 btn-sttng-left-cap text-center justify-content-right mb-1">
                      <p>7</p>
                    <!--
                      <button type="button" class="btn btn-sttng-left-cap btn-lg btn-block">7</button>
                    -->
                    </div>
                        <div class="col-5 btn-sttng-text-display text-center justify-content-right mb-1">
    
                          <h1 class="display-5">MESSAGE BOARD</h1>
                          <!--
                          <p class="text-center" >SYSTEMJ25 ENTERPRISES</p>
                          
                          <a href="#" class="btn-sttng-text-display">AR BUSINESS CARDS</a>
                          
                          <button type="button" class="btn btn-sttng-text-display btn-sm btn-block">8</button>
                          -->  
                        </div>
                        <div class="d-none d-sm-block col-sm-2 col-md-3 col-lg-3 btn-sttng-right-trailer text-center justify-content-right mb-1">
                            <p>9</p>
                        </div>
                        </div>
                        <nav>     
                            <div class="row"> <!--row 2-->
                                <div class="d-none d-sm-none d-md-block col-2 LCARS_Side_Panel">
                                <p>012</p>
                                </div>
        
                                <div class="col-10">
        
                                </div>
                            </div> <!--end of row 2-->
                                   
                            <div class="row h-25">
                                <div class="d-none d-sm-none d-md-block  col-2 LCARS_Side_Panel">012
                                    <!--<p class="h-25">LCARS</p>-->
                                </div>
                                <div class="col-1 sttng-right-leader text-center justify-content-left">1
                                </div>
                                
                                 <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                                <a class=" btn-sttng-text-display justify-content-center" href="index.html">HOME</a>
                                 </div>
                                
                                <div class="col-1 sttng-right-cap text-center justify-content-left">1
                                </div>
                                <div class="col-1 col-md-2">
                                    <!--<p class="h-25">LCARS</p>-->
                                </div>
                                <div class="col-1 sttng-right-leader text-center justify-content-left">5
                                </div>
                                
                                 <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                                <a class=" btn-sttng-text-display justify-content-center" href="sj25_contact.html">CONTACT</a>
                                 </div>
                                
                                <div class="col-1 sttng-right-cap text-center justify-content-left">5
                                </div>
                            </div>
        
                            <div class="row h-25">
                              <div class="d-none d-sm-none d-md-block  col-2 LCARS_Side_Panel">012
                                  <!--<p class="h-25">LCARS</p>-->
                              </div>
                              <div class="col-1 sttng-right-leader text-center justify-content-left">2
                              </div>
                              <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                              <a class="btn-sttng-text-display justify-content-center" href="sj25_3dprinting.html">3D PRINTING</a>
                              </div>
                              <div class="col-1 sttng-right-cap text-center justify-content-left">2
                              </div>
                              <div class="col-1 col-md-2">
                                  <!--<p class="h-25">LCARS</p>-->
                              </div>
                              <div class="col-1 sttng-right-leader text-center justify-content-left">6
                                </div>
                                <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                                <a class="btn-sttng-text-display justify-content-center" href="sj25_messageboard.html">MESSAGE BOARD</a>
                                </div>
                                <div class="col-1 sttng-right-cap text-center justify-content-left">6
                                </div>
                          </div>
        
                          <div class="row h-25">
                              <div class="d-none d-sm-none d-md-block  col-2 LCARS_Side_Panel">012
                                  <!--col-md-8<p class="h-25">LCARS</p>-->
                              </div>
                              <div class="col-1 sttng-right-leader text-center justify-content-left">3
                              </div>
                              <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                              <a class="btn-sttng-text-display" href="sj25_3danimation.html">3D ANIMATION</a>
                              </div>
                              <div class="col-1 sttng-right-cap text-center justify-content-left">3
                              </div>
                              
                          </div>
        
                          <div class="row h-25">
                              <div class="d-none d-sm-none d-md-block  col-2 LCARS_Side_Panel">LCARS
                                  <!--<p class="h-25">LCARS</p>-->
                              </div>
                              <div class="col-1 sttng-right-leader text-center justify-content-left">4
                              </div>
                              <div class="col-3 col-sm-2 col-md-2 col-lg-2 text-center justify-content-center adiv">
                              <a class="btn-sttng-text-display" href="sj25_arbusinesscards.html">AR BUSINESS CARDS</a>
                              </div>
                              <div class="col-1 sttng-right-cap text-center justify-content-left">4
                              </div>
                          </div>
                            <div class="row"> <!--row 3-->  
                              <div class="col-12 LCARS_Bottom_Line">
                                <p>012</p>
                              </div>
                            </div> <!--end of row 3-->
                          </nav>   
                            
                </header>


        <main>
                <div class="row">
                    <div class="col-12 text-white text-center justify-content-center">
                        <h6>The Message Board is for expressing your thoughts about Star Trek.
                        </h6>
                        <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapseExample">
                                CLICK HERE TO SEE THE INSTRUCTIONS FOR THE MESSAGE BOARD:
                            </button>
                        <!--<p class="ES3DSSV_Story">-->
                                <div class="collapse" id="collapseExample">
                                        <div class="card card-body home_page_text">
                               Please type a message under where it says "MESSAGE" and type your name under where
                                it says "NAME" then click the "Post Message" button.  (You must type both a message and a name to post a message
                                 otherwise you will get an Invalid Message or Invalid Name error and the message
                                  won't post.)  Posted messages will appear under where it says "LIST OF POSTED MESSAGES".
                                The names of people who posted messages are listed under where it
                                 says "MESSAGE AUTHORS LIST". If you click on an author's name, you 
                                 will only see the messages from that author listed until you click
                                  on "VIEW ALL MESSAGES AND ALL AUTHORS".  By default, the messages
                                   are listed in the order in which they were posted (Chronological Order, most recent message last). 
                                   You can view the messages in Reverse Chronological Order (most recent message first) by clicking on
                                    the "SORT MODE" button and selecting the Reverse option.
                                </div>
                            </div>    
                        <!--</p>-->
                    </div>
                </div>
                <!--
                <div class="row">
                        <div class="col-12 col-sm-5 justify-content-center">
                            <h5 class="text-white text-center" id="sortModeDisplay">SORT MODE IS CHRONOLOGICAL</h5>
                            <h5 class="text-white text-center" id="viewModeDisplay">NOW VIEWING ALL MESSAGES</h5>             

                        </div>
                        <div class="col-12 col-sm-7 font-weight-bold text-center LCARS_Top_Line mt-1">
                            <p>List of Posted Messages:</p>
                            <button type="button" class="btn btn-primary btn-sm m-1" id="viewAll">View All Messages and All Authors</button>
                        </div>
                </div>
                -->
                <div class="form-row">
                    <div class="col-12 col-md-6">

                        <div class="row">

                            <div class="col">
                                    <div class="col-12 justify-content-center">

                                            <h6 class="text-white text-center" id="sortModeDisplay">SORT MODE IS CHRONOLOGICAL</h6>
                                            <h6 class="text-white text-center" id="viewModeDisplay">NOW VIEWING ALL MESSAGES</h6>             
                
                                    </div>

                            </div>

                            <div class="col-12 text-center font-weight-bold LCARS_Message_Panel">
                                <p>Message Creation Panel:</p>
                                <div class="row justify-content-center">
                                    <button type="button" class="btn btn-primary btn-sm m-1" id ="postMessage">Post Message</button>
                                    <!--
                                    <button type="button" class="btn btn-primary btn-sm m-1" id ="clearMessage">Clear Message</button>
                                    -->
                                </div>
                            </div>

                        </div>
                        <!--style="display:none;"-->
                        <div class="row" id="messagePanel">
                            <label class="col-12 text-white text-center">MESSAGE</label>
                            <div class="col">
                                <div class="form-row m-1">
                                    <div class="col">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <button type="button" class="btn btn-primary btn-sm expandButton" data-toggle="modal" data-target="#messageCreationModalScrollable" id="messageCreationExpandButton">Expand</button>
                                            </div>
                                            <textarea class="form-control" placeholder="Type Message..." id="messageText"></textarea>
                                        </div>
                                    </div>
                                </div>  
                                <div class="form-row m-1">
                                    
                                    <div class="col">
                                        <label class="col-12 text-white text-center">NAME</label>
                                        <input type="text" class="form-control" placeholder="Type Name..." id="authorName">
                                        <!--<textarea class="form-control" placeholder="Type Name..." id="authorName"></textarea>-->
                                    </div>
                                        
                                    <div class="col">
                                        <textarea class="form-control" placeholder="Time/Date" id="timeDateDisplay" readonly></textarea>
                                    </div>  
                                </div>
                            </div>


                        </div>
                        <div class="row">
                            <div class="col-4 LCARS_Message_Authors_Side_Panel">
                               <p>345</p>
                            </div>    
                            <div class="col-8 text-center font-weight-bold LCARS_Message_Authors_Panel">
                                MESSAGE AUTHORS LIST
                                <div class="dropdown">
                                        <button class="btn btn-primary btn-sm dropdown-toggle m-1" type="button" id="sortModeMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                          SORT MODE
                                        </button>
                                        <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                          <button class="dropdown-item" href="#" id="chronoButton">Chronological</button>
                                          <button class="dropdown-item" href="#"id="reverseButton">Reverse</button>
                                          
                                        </div>
                                </div>
                            </div>

                        </div>    
                        <div class="row">
                                <div class="col-4 LCARS_Message_Authors_Lower_Side_Panel">910
                                      
                                </div>    
                                <div class="col" id="authorList">
                                  
                                </div>
    
                        </div>

                      
                    </div>

                    <div class="col-12 col-md-6 mt-1">
                            <div class="font-weight-bold text-center LCARS_Top_Line">
                                <p>LIST OF POSTED MESSAGES:</p>
                                <button type="button" class="btn btn-primary btn-sm m-1" id="viewAll">VIEW ALL MESSAGES AND ALL AUTHORS</button>
                            </div>    
                            <div class="col-12" id="messageList">

                            </div>
                    </div>            
                </div>    

                <div class="row">
                        <div class="col-12 LCARS_Complete_Line mb-1 mt-1">
                                <p>678</p>
                        </div>
                </div>    
            
            <!-- Button trigger modal -->
      <!--          
      <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#messageCreationModalScrollable" id="modalLaunch">
        Launch Message Creation Modal
      </button>
      -->
      <!--Message Expand Modal -->
      <div class="modal fade" id="exampleModalScrollable" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="modalTitle">Modal title</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body" id="modalBody">
                    Yes I do. When Barkley was affected by the Cytherian probe, he evolved to where he created a "neural scan interface" with the Enterprise's computer thus becoming and answering as the Enterprise's computer and then he controlled the warp engines to "manipulate sub-space in a way that's never been conceived before" propelling the Enterprise to the home planet of the Cytherians.  Both this incident and the path of Worf's shuttle in "Parallels" took place near the Argus array so I that's why I believe the two are linked.  In manipulating sub-space, Barkley must have damaged or changed  the space in that region so that is was in a state of quantum instability.
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <!--<button type="button" class="btn btn-primary">Save changes</button>-->
            </div>
          </div>
        </div>
      </div>    

      <!--Message Creation Modal -->
      <div class="modal fade" id="messageCreationModalScrollable" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title" id="creationModalTitle">Message Creation Panel</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close" id="XCloseButton">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                
                <div class="row">
                    <label class="col-12 text-dark text-center">MESSAGE</label>
                    <div class="col">
                        
                        <div class="modal-body" id="CreationModalBody">
                            <textarea class="form-control" minlength="1" wrap required placeholder="Type Message..." id="mcmMessageText"></textarea>    
                        </div>
                    </div>
                </div>
                
                <div class="form-row m-1">
                        
                        <div class="col justify-content-center">
                            <label class="col-12 text-dark text-center justify-content-center">NAME</label>                           
                                
                            <input type="text" class="form-control" placeholder="Type Name..." id="mcmAuthorName">
                                <!--<textarea class="form-control" placeholder="Type Name..." id="authorName"></textarea>-->
                            
                        </div>    
                        <div class="col justify-content-right">
                            <textarea class="form-control" placeholder="Time/Date" id="mcmTimeDateDisplay" readonly></textarea>
                        </div>  
                    </div>
                    
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal" id="messageCreationCloseButton">Close</button>
                  <button type="button" class="btn btn-primary" id="mcmPostMessage">Post Message</button>
                </div>
              </div>
            </div>
          </div>

        </main>        


      </div>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    
    <!-- Optional JavaScript -->
    <script>
        console.log("Javascript is working!")

        function makeTimeDateStamp() {
            const messageDateString = new Date().toString()
            const splitDateTime = messageDateString.split(' ')
            const monthIndex = 1
            const dayIndex = 2
            const yearIndex = 3
            const timeIndex = 4

            const messageTimeDateString = splitDateTime[timeIndex] + " " + 
                splitDateTime[monthIndex] + " " + splitDateTime[dayIndex] + " " + 
                splitDateTime[yearIndex]

            return  messageTimeDateString  
        }

        function convertTimeDateStampToStandardDisplay (targetTimeDateStamp) {
            const splitTimeDateStamp = targetTimeDateStamp.split(' ')

            const timeIndex = 0
            const monthIndex = 1
            const dayIndex = 2
            const yearIndex = 3
            
            const militaryTime = splitTimeDateStamp[timeIndex]
            const splitMilitaryTime =  militaryTime.split(':')
            const hoursIndex = 0
            const minutesIndex = 1
            const secondsIndex = 2

            const militaryHours = parseInt(splitMilitaryTime[hoursIndex])

            let displayHours = 0
            let displayAMPM = ""

            if (militaryHours > 12) {
                displayHours = militaryHours - 12
                displayAMPM = "PM"
            } else if (militaryHours == 12) {
                displayHours = militaryHours
                displayAMPM = "PM"
            } else if (militaryHours > 0) {
                displayHours = militaryHours
                displayAMPM = "AM"
            } else if (militaryHours == 0) {
                displayHours = 12
                displayAMPM = "AM"
            }

            const standardDisplayTime = displayHours.toString() + ":" + splitMilitaryTime[minutesIndex] + 
                ":" + splitMilitaryTime[secondsIndex] + displayAMPM + "\n" + splitTimeDateStamp[monthIndex] +
                " " + splitTimeDateStamp[dayIndex] + " " + splitTimeDateStamp[yearIndex]

            return standardDisplayTime    

        }

        const timeDateDisplay = document.getElementById('timeDateDisplay')
        const mcmtimeDateDisplay = document.getElementById('mcmtimeDateDisplay')

        function writeTimeDateToDisplay() {
            const currentTimeDateStamp = makeTimeDateStamp()
            const currentTimeDateDisplay = convertTimeDateStampToStandardDisplay(currentTimeDateStamp)
            timeDateDisplay.value = currentTimeDateDisplay
            mcmTimeDateDisplay.value = currentTimeDateDisplay
        }
        

        
        interval = setInterval(writeTimeDateToDisplay,1000);
        
        const postMessageButton = document.getElementById('postMessage')
        const messageTextArea = document.getElementById('messageText')
        const authorNameInput = document.getElementById('authorName')
        
        const messageList = document.getElementById('messageList')
        const authorList = document.getElementById('authorList')
        let authorInputs = document.getElementsByClassName('authorInput')
        const clearMessageButton = document.getElementById('clearMessage')

        const messagePanel = document.getElementById('messagePanel')
        let messageDisplays = document.getElementsByClassName("messageDisplay")
        const viewAllButton = document.getElementById("viewAll")
        const modalLaunchButton = document.getElementById('modalLaunch')

        const modalBody = document.getElementById('modalBody')
        const modalTitle = document.getElementById('modalTitle')
        let expandButtons = document.getElementsByClassName('expandButton')

        const messageCreationExpandButton = document.getElementById('messageCreationExpandButton')
        const mcmMessageTextArea = document.getElementById('mcmMessageText')
        const mcmAuthorNameInput = document.getElementById('mcmAuthorName')
        const mcmPostMessageButton = document.getElementById('mcmPostMessage')
        const messageCreationCloseButton = document.getElementById('messageCreationCloseButton')
        const sortModeMenuButton = document.getElementById('sortModeMenuButton')
        const messageCreationXCloseButton = document.getElementById('XCloseButton')
                
        let messages = new Array()
        let messageId = 0
        let authors = []
        let viewMode = "ALL"
        let viewModeDisplay = document.getElementById('viewModeDisplay')

        const reverseButton = document.getElementById('reverseButton')
        let sortMode = "CHRONOLOGICAL"
        const sortModeDisplay = document.getElementById('sortModeDisplay')
        const chronoButton = document.getElementById('chronoButton')

        const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec']

        // Define an object factory that will accept our data and return a message object
        const messageFactory = (messageText, authorName, timeDateStamp) => {
            const id = messageId
            messageId++
            return {messageText, authorName, timeDateStamp,id}
        }

        // Define a factory that returns HTML based on the contents of the message object
        const messageHTML = (targetMessage) => {
            
            const messageTimeDateDisplay = convertTimeDateStampToStandardDisplay (targetMessage.timeDateStamp)
            //<button type="button" class="btn btn-primary btn-sm m-1 enlargeButton" id ="message">Enlarge</button>
            //<span class="input-group-text">Enlarge</span>

            const html = `<form>
                            <div class="m-2 messageDisplay" id="${targetMessage.id}">
                                <div class="form-row m-1">
                                    <div class="col">
                                        <div class="input-group">
                                            <div class="input-group-prepend">
                                                <button type="button" class="btn btn-primary btn-sm expandButton" data-toggle="modal" data-target="#exampleModalScrollable" id="${targetMessage.id}">Expand</button>
                                            </div>
                                            <textarea class="form-control" placeholder="Message Text" readonly>${targetMessage.messageText}</textarea>
                                        </div>
                                    </div>
                                    </div>  
                                    <div class="form-row m-1">
                                        <div class="col">
                                        <input type="text" class="form-control" placeholder="First Name Last Name" value="${targetMessage.authorName}" readonly>
                                        </div>
                                    
                                        <div class="col">
                                        <textarea class="form-control" placeholder="Time/Date" readonly>${messageTimeDateDisplay}</textarea>
                                        </div>  
                                    </div> 
                                </div>    
                            </form>`
            return html
        }

        // Define a factory that returns HTML to add an authors name to the list
        const authorHTML = (targetAuthor) => {
            const html = `<input type="text" class="authorInput form-control m-1" placeholder="First Name Last Name" value="${targetAuthor}" readonly>`

            return html

        }

        function clearMessageListDisplay() {
            //while (messageList.firstChild) {
            //    //The list is LIVE so it will re-index each call
            //    messageList.removeChild(taskList.firstChild);
            //}
            messageList.innerHTML = ""    

        }

                
        const createExpandButtonEventListener = (ebReference) => {
            
            ebReference.addEventListener('click', event => {
                        
                console.log(`An expandButton was clicked on`)
                console.log(`The expandButton's id Number was ${ebReference.id}`)
                //console.log(`The author was ${authorInput.value}`)
                const mIDNumber = parseInt(ebReference.id)
                modalBody.innerHTML = messages[mIDNumber].messageText
                const messageTimeDateDisplay = convertTimeDateStampToStandardDisplay(messages[mIDNumber].timeDateStamp)
                //messages[0].timeDateStamp
                modalTitle.innerHTML =  messages[mIDNumber].authorName + "'s " + messageTimeDateDisplay + " Message"

                })

        }

        function renderMessage(messageToRender) {
            // Generate our html
            const htmlString = messageHTML(messageToRender)
            const fragment = document.createRange().createContextualFragment(htmlString)
            
            // Add the task to the container
            messageList.appendChild(fragment)

            expandButtons = document.getElementsByClassName('expandButton')
            const expandButton = expandButtons[expandButtons.length-1]

            createExpandButtonEventListener(expandButton)

            if (viewMode != "ALL") {
                
                // message.authorName != viewMode 
                if (messageToRender.authorName != viewMode ) {
                    // make the current message disappear
                    messageDisplays = document.getElementsByClassName("messageDisplay")
                    //messageDisplays[messageDisplays.length-1].style = "display:none;"
                    messageDisplays[messageDisplays.length-1].classList.add('d-none')
                }
            }    
        }

        function renderMessages(messagesToRender) {

            if (messagesToRender.length > 0) {
                
                messagesToRender.forEach(function(message){
                    renderMessage(message)
                })
                
            }
            else {
                console.log(`There are no messages to render`)
            }
        }

        const createAuthorInputEventListener = (aiReference) => {

            aiReference.addEventListener('click', event => {
                //const tempAuthorInputValue = authorInput.value
                console.log(`An authorInput was clicked on`)
                console.log(`The author was ${aiReference.value}`)

                viewMode = aiReference.value
                viewModeDisplay.innerHTML = "NOW VIEWING " + viewMode + "'s MESSAGES"

                //authorInput.style ="display:none;"

                let authorMessageIndices = []
                // Determine which messages are from the author who was clicked on
                // Go through the messages

                messages.forEach(function(message){
                    // if the message was from the author
                    if (message.authorName == aiReference.value) {
                        // Add the message number to the list 
                        authorMessageIndices.push(message.id)
                    }
                })
                
                // Print the number of messages that were posted by the author
                console.log(`The number of messages that were posted by the author was ${authorMessageIndices.length}`)
                // Print the message text for each message that was posted by the author
                console.log(`The author's messages were:`)

                authorMessageIndices.forEach(function(index) {
                    console.log(`Message[${index}]: ${messages[index].messageText}`)
                })
                
                //Make all authorInputs disappear
                for (aI=0;aI<authorInputs.length;aI++) {
                    //authorInputs[aI].style = "display:none;"
                    authorInputs[aI].classList.add('d-none')
                }
                                
                //Make the authorInput that was clicked on reappear
                //aiReference.style ="display:block;"
                aiReference.classList.remove('d-none')

                messageDisplays = document.getElementsByClassName("messageDisplay")
                //Make all message displays disappear
                for (mD=0;mD<messageDisplays.length;mD++) {
                    //messageDisplays[mD].style = "display:none;"
                    messageDisplays[mD].classList.add('d-none')
                }    
                
                //Go through all the messages and make the ones from the author reappear
                for (mDI=0;mDI<messageDisplays.length;mDI++) {

                    authorMessageIndices.forEach(function(authorMessageIndex){
                        //console.log(`Message[${mDI}] is being tested against authorMessageIndices[${mAI}`)
                        const messageDisplayId = parseInt(messageDisplays[mDI].id)
                        if (messageDisplayId == authorMessageIndex) {
                            console.log(`Making messageDisplay ${mDI} reappear`)
                            //messageDisplays[mDI].style = "display:block;"
                            messageDisplays[mDI].classList.remove('d-none')
                        }
                    })
                    
                }

            })
        }    

        function renderAuthor(authorToRender) {
            // Generate our html
            const htmlString = authorHTML(authorToRender)
            const fragment = document.createRange().createContextualFragment(htmlString)
            
            // Add the author's input to the container
            authorList.appendChild(fragment)

            authorInputs = document.getElementsByClassName('authorInput')

            if (authorInputs) {
                
                const authorInput = authorInputs[authorInputs.length-1]
                createAuthorInputEventListener(authorInput)
                               
            }
        }

        function renderAuthors(authorsToRender) {

            if (authorsToRender.length > 0) {

                authorsToRender.forEach(function(author){
                    renderAuthor(author)
                })    

            }
            else {
                console.log(`There are no authors to render`)
            }
 
        }
        
        messageCreationExpandButton.addEventListener('click', event => {
            //console.log(`messageCreationExpandButton Press detected`)
            
            mcmMessageTextArea.value = messageTextArea.value
            mcmAuthorNameInput.value = authorNameInput.value 
        })

        messageCreationCloseButton.addEventListener('click', event => {
            messageTextArea.value = mcmMessageTextArea.value
            authorNameInput.value = mcmAuthorNameInput.value
        })

        messageCreationXCloseButton.addEventListener('click', event => {
            messageTextArea.value = mcmMessageTextArea.value
            authorNameInput.value = mcmAuthorNameInput.value
        })

        function convertIndexToSortableIndexString(theIndex) {
            // adds leading zeros to an index number so it can be sorted
            const lastIndex = messages.length-1
            const lastIndexString = lastIndex.toString()
            const numberOfDigitsInTheLastIndex = lastIndexString.length

            const currentIndexString = theIndex.toString()
            const numberOfDigitsIntheCurrentIndex = currentIndexString.length

            const numberOfLeadingZeros = numberOfDigitsInTheLastIndex - numberOfDigitsIntheCurrentIndex

            let theSortableIndexString  = ""

            for (lZIndex=0;lZIndex<numberOfLeadingZeros;lZIndex++) {
                //sortableIndexString.push("0")
                theSortableIndexString += "0"
            } 
            //sortableIndexString.push(targetIndex)
            theSortableIndexString += theIndex.toString()

            return theSortableIndexString
        }

        function convertTimeDateStampIntoSortableTimeDate(targetTimeDateStamp,targetMessageId) {
            //messageTimeDateString = splitDateTime[timeIndex] + " " + 
            //splitDateTime[monthIndex] + " " + splitDateTime[dayIndex] + " " + 
            //    splitDateTime[yearIndex]
            const timeIndex = 0
            const monthIndex = 1
            const dayIndex = 2
            const yearIndex = 3

            const splitTimeDateStamp = targetTimeDateStamp.split(" ")
            console.log(`year is ${splitTimeDateStamp[yearIndex]}`)
            console.log(`month is ${splitTimeDateStamp[monthIndex]}`)

            const monthNumber = months.indexOf(splitTimeDateStamp[monthIndex]) + 1
            let sortableMonth = ""
            if (monthNumber < 10) {
                sortableMonth = "0" + monthNumber.toString()
            } else {
                sortableMonth = monthNumber.toString()
            }

            const militaryTime = splitTimeDateStamp[timeIndex]
            const splitMilitaryTime = militaryTime.split(":")
            const mtHourIndex = 0
            const mtMinuteIndex = 1
            const mtSecondIndex = 2
            const sortableTime = splitMilitaryTime[mtHourIndex] + 
            splitMilitaryTime[mtMinuteIndex] + splitMilitaryTime[mtSecondIndex]

            console.log(`day is ${splitTimeDateStamp[dayIndex]}`)
            console.log(`time is ${splitTimeDateStamp[timeIndex]}`)
            const sortableIndexString = convertIndexToSortableIndexString(targetMessageId)
            console.log(`sortableIndexString is ${sortableIndexString}`)

            const sortableTimeDate = splitTimeDateStamp[yearIndex] + sortableMonth + 
            splitTimeDateStamp[dayIndex] + sortableTime + sortableIndexString
            console.log(`sortableTimeDate is ${sortableTimeDate}`)
            return sortableTimeDate
        }
        
        function doAReverseSort() {
            if (messages.length >=2) {       
                // resort the message list in reverse order
                let sortedArrayOfSortableTimeDates = []
        
                // Extract the timedates from the array of task objects and put them
                // into an array to be sorted as well as another array for comparison
                                
                messages.forEach(function(message){
                    // Convert each timedate into a sortable form
                    const currentSortableTimeDate = convertTimeDateStampIntoSortableTimeDate(message.timeDateStamp,message.id)
                    
                    // Store the timedates
                    sortedArrayOfSortableTimeDates.push(currentSortableTimeDate)
                })
                

                // Sort the timedates
                //sortedArrayOfSortableTimeDates.sort()
                //sortedArrayOfSortableTimeDates.reverse()
                
                //perform reverse sort on timedates
                // sort by name
                sortedArrayOfSortableTimeDates.sort(function(firstTimeDate, secondTimeDate) {
                
                if (firstTimeDate < secondTimeDate) {
                    return 1;
                }
                if (firstTimeDate > secondTimeDate) {
                    return -1;
                }

                // names must be equal
                return 0;
                })

                // Create an new reverse sorted array of messages
                let reverseSortedMessages = new Array()

                const lastIndex = messages.length-1
                const lastIndexString = lastIndex.toString()
                const numberOfDigitsInTheLastIndex = lastIndexString.length

                for (rsmIndex=0;rsmIndex<messages.length;rsmIndex++) {
                    
                    const currentSortedTimeDate = sortedArrayOfSortableTimeDates[rsmIndex]
                    const currentIdString = currentSortedTimeDate.slice(-numberOfDigitsInTheLastIndex)
                    const currentId = parseInt(currentIdString)

                    // find the index of the message with the currentId
                    const messageIndex = messages.findIndex(targetMessage => targetMessage.id == currentId)
                
                    const currentRSMessage = messages[messageIndex]

                    reverseSortedMessages.push(currentRSMessage)
                }
                console.log(`reverseSortedMessages:`)
                console.log(reverseSortedMessages)
                return reverseSortedMessages

            } else {
                  console.log(`messages could not be sorted because there are less then 2 messages`)
            }    
                
        }

        reverseButton.addEventListener('click', event => {
            //chronoButton.classlist.remove('active')
            console.log("Reverse button was pressed")
            //messagePanel = document.getElementById('messagePanel')
            //messageDisplays = document.getElementsByClassName("messageDisplay")
            if (sortMode == "CHRONOLOGICAL") {
            
                // If there are messages
                if (messages) {

                    if (messages.length >=2 ) {

                        const rsortedMessages = doAReverseSort()
                        if (rsortedMessages) {
                            console.log(`reverseSortedMessages:`)
                            console.log(rsortedMessages)

                            // clear the message list display
                            clearMessageListDisplay()

                            // render the sorted messages
                            renderMessages(rsortedMessages)
                        } else {
                            //if there are no messages
                            console.log('There are no messages to sort')
                            console.log("sortMode will be set to Reverse only")
                        }

                    } else {
                        console.log("2 or more messages are needed to do a sort and there are less than that")
                        console.log("sortMode will be set to Reverse only")
                    }

                } else {
                    console.log('There are no messages to sort')
                    console.log("sortMode will be set to Reverse only")
                }

            } else {
                console.log(`sort Mode is already reverse`)
            }

           sortMode = "REVERSE"
           sortModeDisplay.innerHTML = "SORT MODE IS " + sortMode
        })

        chronoButton.addEventListener('click', event => {
            //reverseButton.classlist.remove('active')           

            console.log("Chrono button was pressed")
            if (sortMode == "REVERSE") {
                if (messages.length >=2) {
                    // clear the message list display
                    clearMessageListDisplay()

                    // render the original messages which are already 
                    // chronologically sorted 
                    renderMessages(messages)

                } else {
                    console.log(`messages could not be sorted because there are less then 2 messages`)
                }

            } else {
                console.log(`sort mode is already chronological`)
            }
            sortMode = "CHRONOLOGICAL"
            sortModeDisplay.innerHTML = "SORT MODE IS " + sortMode
        })

        viewAllButton.addEventListener('click', event => {
            //messageDisplays 
            //Make all authorInputs appear
            for (aI=0;aI<authorInputs.length;aI++) {
                //authorInputs[aI].style = "display:block;"
                authorInputs[aI].classList.remove('d-none')
            }
            //Make all messageDisplays appear
            for (mD=0;mD<messageDisplays.length;mD++) {
                //messageDisplays[mD].style = "display:block;"
                messageDisplays[mD].classList.remove('d-none')
            }

            viewMode = "ALL"
            viewModeDisplay.innerHTML = "NOW VIEWING " + viewMode + " MESSAGES"
        })

        sortModeMenuButton.addEventListener('click', event => {

            if (sortMode == "CHRONOLOGICAL") {
                //set chrono button class to active
                chronoButton.classList.add('active')
                // remove active class from reverse button
                reverseButton.classList.remove('active')

            } else if (sortMode == "REVERSE") {
                // set reverse button class to active 
                reverseButton.classList.add('active')
                //remove active class from chrono button
                chronoButton.classList.remove('active')
                
            }

        })

        function checkIfTheCurrentMessageAuthorMatchesTheViewMode(targetAuthorName) {
            
            if (viewMode != "ALL") {
                
                // message.authorName != viewMode 
                if (targetAuthorName != viewMode ) {
                    authorInputs = document.getElementsByClassName('authorInput')
                    // Make authorInput disappear
                    //authorInputs[authorInputs.length-1].style = "display:none;" 
                    authorInputs[authorInputs.length-1].classList.add('d-none')                  
                }
            }
            
        }

        //const createPriorityEventListener = (pbReference) => {
            //pbReference.addEventListener('click', event => {

        const createPostMessageButtonEventListener = (pmbReference) => {       

            pmbReference.addEventListener('click', event => {
            
                console.log(`Post Message Button id is ${pmbReference.id}`)

            // Determine if message is valid (not empty)

            // Determine if authorname is valid (not empty)
            // Check message text to ensure it isn't empty. Number of characters must be greater than 0
            let messageIsValid = true
           
            if (pmbReference.id == "postMessage") {
                // validate message text and author name on the webpage
                if (messageTextArea.value.length === 0) {
                    // display an error message
                    //descriptionError.classList.remove('d-none')
                    messageTextArea.placeholder = "Invalid message..."
                    mcmMessageTextArea.placeholder = "Invalid message..."

                    messageIsValid = false
                    // Stop anything else from happening
                }

                // Check authorName to ensure it is valid. Number of characters must be greater than 0
                if (authorNameInput.value.length === 0) {
                    // display an error message
                    //priorityError.classList.remove('d-none')
                    authorNameInput.placeholder = "Invalid name..."
                    mcmAuthorNameInput.placeholder = "Invalid name..."

                    messageIsValid = false
                }

            } else if (pmbReference.id == "mcmPostMessage") {
                // validate message text and author name in message creation modal
                if (mcmMessageTextArea.value.length === 0) {
                    // display an error message
                    //descriptionError.classList.remove('d-none')
                    mcmMessageTextArea.placeholder = "Invalid message..."
                    messageTextArea.placeholder = "Invalid message..."

                    messageIsValid = false
                    // Stop anything else from happening
                }

                // Check authorName to ensure it is valid. Number of characters must be greater than 0
                if (mcmAuthorNameInput.value.length === 0) {
                    // display an error message
                    //priorityError.classList.remove('d-none')
                    mcmAuthorNameInput.placeholder = "Invalid name..."
                    authorNameInput.placeholder = "Invalid name..."

                    messageIsValid = false
                }

            }   
         

            if (messageIsValid) {
                // Make a time date stamp for the message
                const messageTimeDateStamp = makeTimeDateStamp()
            
                let messageTextToUse = ""
                let authorNameToUse = ""
                
                if (pmbReference.id == "postMessage") {
                    messageTextToUse = messageTextArea.value
                    authorNameToUse = authorNameInput.value
                } else if (pmbReference.id == "mcmPostMessage") {
                    messageTextToUse = mcmMessageTextArea.value
                    authorNameToUse = mcmAuthorNameInput.value
                }

                // Define our message object
                const message = messageFactory(messageTextToUse, authorNameToUse, messageTimeDateStamp)

                //messageText, authorName, timeDate
                console.log(`message.messageText is ${message.messageText}`)
                console.log(`message.authorName is ${message.authorName}`)
                console.log(`message.timeDateStamp is ${message.timeDateStamp}`)
                
                messages.push(message)


                if (sortMode == "CHRONOLOGICAL") {
                    renderMessage(message)
                } else {
                    if (messages.length >= 2) {
                        // clear display
                        clearMessageListDisplay()
                        // do a reverse sort
                        const rsMessages = doAReverseSort()
                        // display the sorted messages
                        renderMessages(rsMessages)
                    } else {
                        renderMessage(message)
                    }
                }

                if (authors.length > 0) {
                    // if there are authors on the list, check to see if the current message author is already on the list
                    if (!authors.includes(message.authorName)) {
                        // if the current author is not on the list, add the current message author to the list
                        authors.push(message.authorName)
                        renderAuthor(message.authorName)
                        checkIfTheCurrentMessageAuthorMatchesTheViewMode(message.AuthorName)
                        console.log('There are authors on the list.')
                        console.log(`Message author ${message.authorName} was not on the list.`)
                        console.log(`Message author ${message.authorName} was added to the list.`)

                        console.log(`The authors on the list are now: ${authors}`)

                    } else {
                        // If the current message author is already on the list
                        console.log(`Message author ${message.authorName} is already on the list.`)
                    }

                } else {
                    // if there are no message authors on the list then add the current message author
                    authors.push(message.authorName)
                    renderAuthor(message.authorName)
                    checkIfTheCurrentMessageAuthorMatchesTheViewMode(message.AuthorName)
                    console.log('There are no authors on the list.')
                    console.log(`Message author ${message.authorName} was added to the list.`)
                }

                // Reset form elements
                messageTextArea.value = null
                authorNameInput.value = null
                messageTextArea.placeholder = "Type Message..."
                authorNameInput.placeholder="Type Name..."

                mcmMessageTextArea.value = null
                mcmAuthorNameInput.value = null
                mcmMessageTextArea.placeholder = "Type Message..."
                mcmAuthorNameInput.placeholder="Type Name..."
                
            } else {
                console.log("Message was invalid")
            }
        })

    }

        createPostMessageButtonEventListener(postMessageButton)
        createPostMessageButtonEventListener(mcmPostMessageButton)

        //messageText, authorName, timeDate
        
        messages[0] = messageFactory("StarTrek is great!", "Jack Eisenfeld", "16:26:20 Jul 05 2019")
        messages[1] = messageFactory("StarTrek is awesome!", "Jacutus0fB0rg", "16:46:16 Jul 05 2019")
        messages[2] = messageFactory("Indeed, your logic is impeccable.", "Spock", "16:52:52 Jul 05 2019")
        messages[3] = messageFactory('In Star Trek the Next Generation, do you believe that Barclay was responsible for the quantum fissure that caused Worf to shift into other quantum universes in the episode "Parallels"?', "Jack Eisenfeld", "16:55:55 Jul 05 2019")
        messages[4] = messageFactory(`Yes I do. When Barclay was affected by the Cytherian probe, he evolved to where he created a "neural scan interface" with the Enterprise's computer thus becoming and answering as the Enterprise's computer and then he controlled the warp engines to "manipulate sub-space in a way that's never been conceived before" propelling the Enterprise to the home planet of the Cytherians.  Both this incident and the path of Worf's shuttle in "Parallels" took place near the Argus array so I that's why I believe the two are linked.  In manipulating sub-space, Barclay must have damaged or changed  the space in that region so that is was in a state of quantum instability.`, "Jacutus0fB0rg", "16:57:25 Jul 05 2019")
        messages[5] = messageFactory(`Let's see what's out there. Engage!`, "Jean-Luc Picard", "17:55:29 Jul 06 2019")
        messages[6] = messageFactory(`Live long and prosper.`, "Spock", "22:15:38 Jul 06 2019")

        renderMessages(messages)

        authors[0] = "Jack Eisenfeld"
        authors[1] = "Jacutus0fB0rg"
        authors[2] = "Spock"
        authors[3] = "Jean-Luc Picard"

        renderAuthors(authors)

        //To have reverse sort be set on startup
        // First set sortmode to reverse
        // sortMode = "REVERSE"
        // Second do a reverse sort on the messages
        // const forcedsortedmessages = doAReverseSort()
        // Third render the messages
        // renderMessages(forcedsortedmessages)

    </script>
  </body>
</html>